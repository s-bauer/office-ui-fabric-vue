<template>
    <div :class="classNames.root">
        <OfficeLabel v-if="!!label" :for="id" :class="classNames.label">{{ label }}</OfficeLabel>
        <div :class="classNames.container">
            <button :class="classNames.pill"
                    :disabled="disabled"
                    :id="id"
                    @click="onClick"
                    role="switch"
                    type="button">
                <div :class="classNames.thumb"></div>
            </button>
            <OfficeLabel v-if="!!stateText" :class="classNames.text">{{ stateText }}</OfficeLabel>
        </div>
    </div>
</template>

<script lang="ts">
    import OfficeLabel                   from "../Label/OfficeLabel.vue";
    import {getStyles}                   from "./OfficeToggle.styles";
    import {IOfficeToggleProps}          from "./OfficeToggle.types";
    import {loadTheme}                   from "@s-bauer/uifabric-styling";
    import {getId}                       from "@s-bauer/uifabric-utilities";
    import {mergeStyleSets}              from "@uifabric/merge-styles";
    import {Component, Model, Prop, Vue} from "vue-property-decorator";

    @Component({
        components: {
            OfficeLabel
        }
    })
    export default class OfficeToggle extends Vue implements IOfficeToggleProps {
        // @formatter:off
        @Model("change", {type: Boolean, default: false}) public checked!: boolean;
        @Prop({type: Boolean, default: false})            public disabled!: boolean;
        @Prop({type: String})                             public label?: string;
        @Prop({type: String})                             public onText?: string;
        @Prop({type: String})                             public offText?: string;
        // @formatter:on

        private id = getId("Toggle");

        private get stateText() {
            return this.checked ? this.onText : this.offText;
        }

        private get classNames() {
            return mergeStyleSets(getStyles({
                theme:    loadTheme({}),
                checked:  this.checked,
                disabled: this.disabled
            }));
        }

        private onClick() {
            if (!this.disabled) {
                this.$emit("change", !this.checked);
                this.$emit("click");
            }
        }
    }
</script>
